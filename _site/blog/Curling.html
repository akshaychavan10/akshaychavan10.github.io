<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by yousinix
  Free for personal and commercial use under the MIT license
  https://github.com/yousinix/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Curling">
  <meta property="og:description" content="HackTheBox - Medium">
  <meta property="og:image" content="/assets/img/profile.png">

  <title>Curling</title>
  <meta name="description" content="HackTheBox - Medium">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>


<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>Akshay Chavan</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto"><a class="nav-item nav-link " href="/projects/">Projects</a>

      <a class="nav-item nav-link active" href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  <h1><b>Curling</b></h1>

<p class="post-metadata text-muted">
  27 September 2023 -  
  <b>4 mins read time</b>

  <br>Tags: 
    
    <a class="text-decoration-none no-underline" href="/blog/tags#credentialdisclosure">
      <span class="tag badge badge-pill text-primary border border-primary">CredentialDisclosure</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#cronjob">
      <span class="tag badge badge-pill text-primary border border-primary">CronJob</span>
    </a>
    </p>

<p><img src="/assets/ctf/htb_media/curlinginfocard.png" alt="info card" /></p>

<h2 id="introduction">Introduction</h2>

<p>Curling is a medium-difficulty machine on HackTheBox that involves exploiting a Joomla Content Management System (CMS) to gain initial access and leveraging cron jobs for privilege escalation. This walkthrough will guide you through the process of compromising the Curling machine, from initial reconnaissance to gaining root access.</p>

<h2 id="initial-enumeration">Initial Enumeration</h2>

<h3 id="nmap-scan">Nmap Scan</h3>

<p>The first step in any penetration test is enumeration. We start by scanning the target machine using Nmap to identify open ports and services.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>nmap <span class="nt">-sV</span> <span class="nt">-sC</span> <span class="nt">-oA</span> nmap/initial 10.10.10.150
</code></pre></div></div>

<p><strong>Nmap Results:</strong></p>

<pre><code class="language-nmap">Starting Nmap 7.80 ( https://nmap.org ) at 2020-12-07 02:37 EST
Nmap scan report for 10.10.10.150
Host is up (0.23s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 7.6p1 Ubuntu 4 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   2048 8a:d1:69:b4:90:20:3e:a7:b6:54:01:eb:68:30:3a:ca (RSA)
|   256 9f:0b:c2:b2:0b:ad:8f:a1:4e:0b:f6:33:79:ef:fb:43 (ECDSA)
|_  256 c1:2a:35:44:30:0c:5b:56:6a:3f:a5:cc:64:66:d9:a9 (ED25519)
80/tcp open  http    Apache httpd 2.4.29 ((Ubuntu))
|_http-generator: Joomla! - Open Source Content Management
|_http-server-header: Apache/2.4.29 (Ubuntu)
|_http-title: Home
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.24 seconds
</code></pre>

<p><strong>Key Services Identified:</strong></p>

<ul>
  <li><strong>SSH (22):</strong> OpenSSH 7.6p1</li>
  <li><strong>HTTP (80):</strong> Apache httpd 2.4.29 with Joomla CMS</li>
</ul>

<h3 id="web-enumeration">Web Enumeration</h3>

<p><img src="/assets/ctf/htb_media/curlinghomepage.png" alt="homepage" /></p>

<p>Visiting the HTTP service on port 80 revealed a Joomla blog site. We initiated a <code class="language-plaintext highlighter-rouge">ffuf</code> scan to enumerate directories.</p>

<p><strong>Directory Brute-Forcing:</strong></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffuf <span class="nt">-w</span> ./wordlist <span class="nt">-u</span> http://10.10.10.150/FUZZ
</code></pre></div></div>

<p><img src="/assets/ctf/htb_media/curlingffuf.png" alt="ffuf" /></p>

<p><strong>Key Directories Identified:</strong></p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">/administrator</code></li>
  <li><code class="language-plaintext highlighter-rouge">/templates</code></li>
  <li><code class="language-plaintext highlighter-rouge">/components</code></li>
</ul>

<h3 id="discovering-the-joomla-administrator-login">Discovering the Joomla Administrator Login</h3>

<p>In the <code class="language-plaintext highlighter-rouge">/administrator</code> directory, we found the default Joomla login page. By inspecting the blog posts, we discovered the author name: <code class="language-plaintext highlighter-rouge">Floris</code>.</p>

<p><strong>Author Name:</strong></p>

<p><img src="/assets/ctf/htb_media/curlingfounduser.png" alt="founduser" /></p>

<h3 id="extracting-credentials">Extracting Credentials</h3>

<p>At the bottom of the source code, we found a comment referencing <code class="language-plaintext highlighter-rouge">secret.txt</code>. Accessing this file revealed a base64-encoded string:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Q3VybGluZzIwMTgh
</code></pre></div></div>

<p>Decoding this string provided the password:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Curling2018!
</code></pre></div></div>

<h3 id="gaining-initial-access">Gaining Initial Access</h3>

<p>Using the credentials <code class="language-plaintext highlighter-rouge">floris:Curling2018!</code>, we logged into the Joomla administration page. To gain a shell, we uploaded a PHP reverse shell via the template editor.</p>

<p><img src="/assets/ctf/htb_media/curlingshell.png" alt="Upload Shell" /></p>

<h2 id="privilege-escalation">Privilege Escalation</h2>

<h3 id="enumerating-user-files">Enumerating User Files</h3>

<p>In the <code class="language-plaintext highlighter-rouge">floris</code> home directory, we found a file named <code class="language-plaintext highlighter-rouge">password_backup</code> that appeared to be a hexdump.</p>

<p><strong>Hexdump File:</strong></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cat password_backup
00000000: 425a 6839 3141 5926 5359 819b bb48 0000  BZh91AY&amp;SY...H..
00000010: 17ff fffc 41cf 05f9 5029 6176 61cc 3a34  ....A...P)ava.:4
00000020: 4edc cccc 6e11 5400 23ab 4025 f802 1960  N...n.T.#.@%...`
00000030: 2018 0ca0 0092 1c7a 8340 0000 0000 0000   ......z.@......
00000040: 0680 6988 3468 6469 89a6 d439 ea68 c800  ..i.4hdi...9.h..
00000050: 000f 51a0 0064 681a 069e a190 0000 0034  ..Q..dh........4
00000060: 6900 0781 3501 6e18 c2d7 8c98 874a 13a0  i...5.n......J..
00000070: 0868 ae19 c02a b0c1 7d79 2ec2 3c7e 9d78  .h...*..}y..&lt;~.x
00000080: f53e 0809 f073 5654 c27a 4886 dfa2 e931  .&gt;...sVT.zH....1
00000090: c856 921b 1221 3385 6046 a2dd c173 0d22  .V...!3.`F...s."
000000a0: b996 6ed4 0cdb 8737 6a3a 58ea 6411 5290  ..n....7j:X.d.R.
000000b0: ad6b b12f 0813 8120 8205 a5f5 2970 c503  .k./... ....)p..
000000c0: 37db ab3b e000 ef85 f439 a414 8850 1843  7..;.....9...P.C
000000d0: 8259 be50 0986 1e48 42d5 13ea 1c2a 098c  .Y.P...HB....*..
000000e0: 8a47 ab1d 20a7 5540 72ff 1772 4538 5090  .G.. .U@r..rE8P.
000000f0: 819b bb48                                ...H
</code></pre></div></div>

<h3 id="decoding-the-backup-file">Decoding the Backup File</h3>

<p>Recognizing the <code class="language-plaintext highlighter-rouge">BZh91AY&amp;SY</code> signature, we identified the file as a bzip2 archive. We converted the hexdump back to binary and decompressed it:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>xxd <span class="nt">-r</span> password_backup <span class="o">&gt;</span> newfile
bzip2 <span class="nt">-d</span> newfile
</code></pre></div></div>

<p>This process revealed a gzip file, which we further decompressed to obtain the password:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>5d&lt;wdCbdZu)|hChXll
</code></pre></div></div>

<p><strong>Password File:</strong></p>

<p><img src="/assets/ctf/htb_media/curlingpassfile.png" alt="Password File" /></p>

<h3 id="accessing-user-shell">Accessing User Shell</h3>

<p>Using the discovered password, we SSHed into the machine as <code class="language-plaintext highlighter-rouge">floris</code>:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ssh floris@10.10.10.150
</code></pre></div></div>

<p><strong>User Shell Obtained:</strong></p>

<p><img src="/assets/ctf/htb_media/curlinguser.png" alt="User Shell" /></p>

<h2 id="privilege-escalation-to-root">Privilege Escalation to Root</h2>

<h3 id="discovering-cron-jobs">Discovering Cron Jobs</h3>

<p>In the <code class="language-plaintext highlighter-rouge">floris</code> home directory, we found a folder named <code class="language-plaintext highlighter-rouge">admin-area</code> containing two files: <code class="language-plaintext highlighter-rouge">input</code> and <code class="language-plaintext highlighter-rouge">report</code>. The timestamps of these files changed every few minutes, indicating a cron job.</p>

<p><img src="/assets/ctf/htb_media/curlingadmin-area-files.png" alt="adminfile" /></p>

<h3 id="exploiting-the-cron-job">Exploiting the Cron Job</h3>

<p>We identified a cron job running as root that used the <code class="language-plaintext highlighter-rouge">input</code> file to generate the <code class="language-plaintext highlighter-rouge">report</code> file:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/bin/sh <span class="nt">-c</span> curl <span class="nt">-K</span> /home/floris/admin-area/input <span class="nt">-o</span> /home/floris/admin-area/report
</code></pre></div></div>

<p>To exploit this, we modified the <code class="language-plaintext highlighter-rouge">input</code> file to fetch the root flag:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>url = "file:///root/root.txt"
</code></pre></div></div>

<p><strong>Root Flag Obtained:</strong></p>

<p><img src="/assets/ctf/htb_media/curlingroot.png" alt="Root Flag" /></p>

<h2 id="conclusion">Conclusion</h2>

<p>The Curling machine on HackTheBox provided a comprehensive challenge, encompassing web application enumeration, Joomla exploitation, and cron job privilege escalation. By methodically enumerating services, exploiting discovered credentials, and leveraging cron jobs, we successfully compromised the machine and gained root access. This walkthrough underscores the importance of thorough enumeration and the effective use of discovered vulnerabilities in penetration testing.</p>



</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>Akshay Chavan</strong>
  </small>

  <div class="container-fluid justify-content-center"><a class="social mx-1"  href="mailto:akschavan100@gmail.com"
       style="color: #6c757d"
       onMouseOver="this.style.color='#db4437'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.github.com/akshaychavan10"
       style="color: #6c757d"
       onMouseOver="this.style.color='#333333'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1"  href="https://www.linkedin.com/in/akshaychavan07"
       style="color: #6c757d"
       onMouseOver="this.style.color='#007bb5'"
       onMouseOut="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a>

</div><small id="attribution">
    theme <a href="https://github.com/yousinix/portfolYOU">portfolYOU</a>
  </small>

</footer>

  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

</html>