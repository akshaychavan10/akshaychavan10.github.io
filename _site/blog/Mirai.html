<!DOCTYPE html>

<!--
  portfolYOU Jekyll theme by yousinix
  Free for personal and commercial use under the MIT license
  https://github.com/yousinix/portfolYOU
-->

<html lang="en" class="h-100">

<head>

  
  
  

  

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Mirai">
  <meta property="og:description" content="HackTheBox - Medium">
  <meta property="og:image" content="/assets/img/profile.png">

  <title>Mirai</title>
  <meta name="description" content="HackTheBox - Medium">

  <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon.ico">

  <!-- Theme style -->
  <script src="/assets/js/theme.js"></script>

  <!-- Font Awesome CDN -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.4/css/all.css">

  <!-- Bootstrap CSS CDN -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css">

  <!-- Animate CSS CDN -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.css">

  <!-- Custom CSS -->
  <link rel="stylesheet" href="/assets/css/style.css">

</head>


<body class="h-100 d-flex flex-column">

  <main class="flex-shrink-0 container mt-5">
    <nav class="navbar navbar-expand-lg navbar-themed">

  <a class="navbar-brand" href="/"><h5><b>Akshay Chavan</b></h5></a>

  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
    <i class="fas fa-1x fa-bars text-themed"></i>
  </button>

  <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
    <div class="navbar-nav ml-auto">
<a class="nav-item nav-link " href="/projects/">Projects</a>

      <a class="nav-item nav-link active" href="/blog/">Blog</a>

      <a class="nav-item nav-link " href="/about/">About</a>

      

      <span id="theme-toggler" class="nav-item nav-link" role="button" onclick="toggleTheme()"></span>
    </div>
  </div>

</nav>
    <div class="col-lg-10 mx-auto mt-5 markdown-body">
  <h1><b>Mirai</b></h1>

<p class="post-metadata text-muted">
  14 December 2023 -  
  <b>4 mins read time</b>

  <br>Tags: 
    
    <a class="text-decoration-none no-underline" href="/blog/tags#weakauthentication">
      <span class="tag badge badge-pill text-primary border border-primary">WeakAuthentication</span>
    </a>
    
    <a class="text-decoration-none no-underline" href="/blog/tags#filerecovery">
      <span class="tag badge badge-pill text-primary border border-primary">FileRecovery</span>
    </a>
    </p>

<p><img src="/assets/ctf/htb_media/mirai_info_card.png" alt="info card"></p>

<p>Mirai is an easy-rated box on Hack The Box. It involves exploiting default credentials to gain shell access and using <code class="language-plaintext highlighter-rouge">sudo</code> privileges to escalate to root. Additionally, there’s a forensic challenge to recover the root flag.</p>

<hr>

<h2 id="enumeration">Enumeration</h2>

<p>As always, we start with an <strong>Nmap scan</strong> to identify open ports and services running on the target machine.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Starting Nmap 7.80 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2020-11-28 07:51 EST
Nmap scan report <span class="k">for </span>10.10.10.48
Host is up <span class="o">(</span>0.43s latency<span class="o">)</span><span class="nb">.</span>

PORT      STATE SERVICE VERSION
22/tcp    open  ssh     OpenSSH 6.7p1 Debian 5+deb8u3 <span class="o">(</span>protocol 2.0<span class="o">)</span>
| ssh-hostkey: 
|   1024 aa:ef:5c:e0:8e:86:97:82:47:ff:4a:e5:40:18:90:c5 <span class="o">(</span>DSA<span class="o">)</span>
|   2048 e8:c1:9d:c5:43:ab:fe:61:23:3b:d7:e4:af:9b:74:18 <span class="o">(</span>RSA<span class="o">)</span>
|   256 b6:a0:78:38:d0:c8:10:94:8b:44:b2:ea:a0:17:42:2b <span class="o">(</span>ECDSA<span class="o">)</span>
|_  256 4d:68:40:f7:20:c4:e5:52:80:7a:44:38:b8:a2:a7:52 <span class="o">(</span>ED25519<span class="o">)</span>
53/tcp    open  domain  dnsmasq 2.76
| dns-nsid: 
|_  bind.version: dnsmasq-2.76
80/tcp    open  http    lighttpd 1.4.35
|_http-server-header: lighttpd/1.4.35
|_http-title: Site doesn<span class="s1">'t have a title (text/html; charset=UTF-8).
1285/tcp  open  upnp    Platinum UPnP 1.0.5.13 (UPnP/1.0 DLNADOC/1.50)
32400/tcp open  http    Plex Media Server httpd
| http-auth: 
| HTTP/1.1 401 Unauthorized\x0D
|_  Server returned status 401 but no WWW-Authenticate header.
|_http-cors: HEAD GET POST PUT DELETE OPTIONS
|_http-title: Unauthorized
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 26.67 seconds
</span></code></pre></div></div>

<p>From the Nmap scan, we can see several open ports:</p>
<ul>
  <li>
<strong>Port 22</strong>: SSH (OpenSSH 6.7p1)</li>
  <li>
<strong>Port 53</strong>: DNS (dnsmasq 2.76)</li>
  <li>
<strong>Port 80</strong>: HTTP (lighttpd 1.4.35)</li>
  <li>
<strong>Port 1285</strong>: UPnP</li>
  <li>
<strong>Port 32400</strong>: Plex Media Server</li>
</ul>

<p>My first approach was to enumerate the web service running on <strong>port 80</strong> for more information.</p>

<hr>

<h2 id="exploring-the-web-service">Exploring the Web Service</h2>

<p>I visited the website hosted on port 80, but it didn’t return anything useful. To dig deeper, I used <strong>Burp Suite</strong> to inspect the HTTP requests and responses. After analyzing the response, I discovered that the server is hosting <strong>Pi-hole</strong>, a network-wide ad blocker.</p>

<p><img src="/assets/ctf/htb_media/mirai_response.png" alt="response"></p>

<p>Next, I decided to fuzz for directories using <strong>ffuf</strong> (a web fuzzing tool). I discovered the <code class="language-plaintext highlighter-rouge">/admin</code> directory, which hosts the Pi-hole admin panel.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ffuf <span class="nt">-w</span> /path/to/wordlist <span class="nt">-u</span> http://10.10.10.48/FUZZ
</code></pre></div></div>

<hr>

<h2 id="default-credentials">Default Credentials</h2>

<p>I searched for default credentials for Pi-hole on Google and found that the default username is <code class="language-plaintext highlighter-rouge">pi</code> and the default password is <code class="language-plaintext highlighter-rouge">raspberry</code>. However, when I tried these credentials on the admin panel login page, they didn’t work.</p>

<p><img src="/assets/ctf/htb_media/mirai_creds.png" alt="creds"></p>

<hr>

<h2 id="gaining-shell-access">Gaining Shell Access</h2>

<p>After some research, I checked the <strong>Pi-hole GitHub repository</strong> and learned that Pi-hole uses a random password during setup. This meant I couldn’t use default credentials to log in to the admin panel. However, I decided to try the same credentials (<code class="language-plaintext highlighter-rouge">pi:raspberry</code>) on the SSH service (port 22), and it worked! I gained initial access to the system via SSH.</p>

<p><img src="/assets/ctf/htb_media/mirai_user.png" alt="user"></p>

<hr>

<h2 id="privilege-escalation-to-root">Privilege Escalation to Root</h2>

<p>Once I had access to the user account, the first thing I checked was whether the user had <code class="language-plaintext highlighter-rouge">sudo</code> privileges. Running <code class="language-plaintext highlighter-rouge">sudo -l</code> revealed that the user could execute any command as root using <code class="language-plaintext highlighter-rouge">sudo</code>. I escalated to a root shell using the following command:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo</span> <span class="nt">-i</span>
</code></pre></div></div>

<p><img src="/assets/ctf/htb_media/mirai_root.png" alt="root"></p>

<hr>

<h2 id="forensic-challenge-recovering-the-root-flag">Forensic Challenge: Recovering the Root Flag</h2>

<p>When I tried to read the <code class="language-plaintext highlighter-rouge">root.txt</code> file, I encountered a message indicating that the original <code class="language-plaintext highlighter-rouge">root.txt</code> file was missing and might be backed up on a USB stick.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">cat</span> /root/root.txt
</code></pre></div></div>

<p>Output:</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>I lost my original root.txt! I think I may have a backup on my USB stick...
</code></pre></div></div>

<p>To investigate, I used the <code class="language-plaintext highlighter-rouge">mount</code> command to list mounted devices. It showed that <code class="language-plaintext highlighter-rouge">/dev/sdb</code> was mounted at <code class="language-plaintext highlighter-rouge">/media/usbstick</code>.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mount
</code></pre></div></div>

<p>I navigated to <code class="language-plaintext highlighter-rouge">/media/usbstick</code> and found a file named <code class="language-plaintext highlighter-rouge">damit.txt</code>. This file contained a note from a user named James, explaining that he had accidentally deleted the <code class="language-plaintext highlighter-rouge">root.txt</code> file.</p>

<p><img src="/assets/ctf/htb_media/mirai_damit.png" alt="james note"></p>

<p>Since I had no prior experience with forensics, I used the <code class="language-plaintext highlighter-rouge">strings</code> command to recover the contents of the deleted <code class="language-plaintext highlighter-rouge">root.txt</code> file from the USB stick.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>strings /dev/sdb | <span class="nb">grep</span> <span class="s2">"root.txt"</span>
</code></pre></div></div>

<p>This successfully revealed the root flag.</p>

<p><img src="/assets/ctf/htb_media/mirai_flag.png" alt="FLAG"></p>

<hr>

<h2 id="conclusion">Conclusion</h2>

<p>Mirai was a fun and beginner-friendly box that involved:</p>
<ol>
  <li>Enumerating open ports and services.</li>
  <li>Exploiting default credentials to gain SSH access.</li>
  <li>Using <code class="language-plaintext highlighter-rouge">sudo</code> privileges to escalate to root.</li>
  <li>Recovering a deleted file using basic forensic techniques.</li>
</ol>

<p>This challenge was a great introduction to privilege escalation and basic forensics.</p>

<hr>



</div>
  </main>
  <footer class="mt-auto py-3 text-center">

  <small class="text-muted mb-2">
    <i class="fas fa-code"></i> with <i class="fas fa-heart"></i>
    by <strong>Akshay Chavan</strong>
  </small>

  <div class="container-fluid justify-content-center">
<a class="social mx-1" href="mailto:akschavan100@gmail.com" style="color: #6c757d" onmouseover="this.style.color='#db4437'" onmouseout="this.style.color='#6c757d'">
      <i class="fas fa-envelope fa-1x"></i>
    </a><a class="social mx-1" href="https://www.github.com/akshaychavan10" style="color: #6c757d" onmouseover="this.style.color='#333333'" onmouseout="this.style.color='#6c757d'">
      <i class="fab fa-github fa-1x"></i>
    </a><a class="social mx-1" href="https://www.linkedin.com/in/akshaychavan07" style="color: #6c757d" onmouseover="this.style.color='#007bb5'" onmouseout="this.style.color='#6c757d'">
      <i class="fab fa-linkedin-in fa-1x"></i>
    </a>

</div>
<small id="attribution">
    theme <a href="https://github.com/yousinix/portfolYOU">portfolYOU</a>
  </small>

</footer>

  
  <!-- GitHub Buttons -->
<script async defer src="https://buttons.github.io/buttons.js"></script>

<!-- jQuery CDN -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<!-- Popper.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.6/umd/popper.min.js"></script>

<!-- Bootstrap JS CDN -->
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- wow.js CDN & Activation -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/wow/1.1.2/wow.js"></script>
<script> new WOW().init(); </script>

<!-- Initialize all tooltips -->
<script>
$(function () {
    $('[data-toggle="tooltip"]').tooltip()
})
</script>
</body>

</html>